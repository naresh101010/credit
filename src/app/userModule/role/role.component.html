<div  class="page-section">

  <div class="text-left breadcrud_holder role details" >
    <div class=" leftSide">
      <h2 >Create Role</h2>
      <a href="/dashboard" target="_self">Dashboard</a><span class="fa fa-caret-right"></span><a href="/user-management/role" target="_self"> Role Management </a>
    </div>


    <div class="rightSide">
      <em  class="shortcutskeys">For save use Ctrl+s</em>
    </div>

  </div>




  <mat-card id="shadow" >
    <form name="form" (ngSubmit)="f.form.valid" #f="ngForm" novalidate>
      <div class="row">
        <div class="col-lg-6 col-md-6 col-sm-6">
          <div class="form-group required">
            <div class="control-label col-lg-3  col-md-3 col-sm-3"><label  class="input-label">Role Name</label></div>
            <div class="col-lg-4 col-md-4 col-sm-4">
              <input type="text" class="form-control input-md1" minlength="3" placeholder="Role Name" autocomplete="off" (blur) = "validateUser(model.rolename)"  required [(ngModel)]="model.rolename" name="rolename" #rolename="ngModel" maxlength="50">
              <div *ngIf="(rolename.dirty || rolename.touched) && rolename.invalid" class="invalid-feedback" >
                <div *ngIf="rolename.errors.minlength "  style="width: 120%; top: 19px!important; left: 17px!important;" class="error">Role Name must be three characters</div>
                <div *ngIf="rolename.errors.required " class="error" style="top: 19px!important;  left: 17px!important;">Role Name is Required</div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-6 col-md-6 col-sm-6">
          <div class="form-group required">
            <div class="col-lg-4 col-md-4 col-sm-4"></div>
            <div class="control-label col-lg-3  col-md-3 col-sm-3"><label  class="input-label">Status</label></div>
            <div class="col-lg-4 col-md-4 col-sm-4">

              <ng-select disabled="true"  appendTo="body"
                         name="status"  [(ngModel)]="model.statusValue">
                <ng-option selected="selected"  >Active</ng-option>
                <ng-option >Inactive</ng-option>
              </ng-select>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-6" style="margin-top: 2.5rem;">
          <div class="form-group">
            <div class="control-label col-lg-3  col-md-3 col-sm-3"><label  class="input-label">Description</label></div>
            <div class="col-lg-4 col-md-4 col-sm-4">
            <textarea rows="2" cols="20" wrap="hard" maxlength="100" [(ngModel)]="model.description" class="input-md1 textareaoutline"
                      placeholder="Description" name="textarea" #textarea="ngModel"></textarea>

              <div *ngIf="f.submitted && textarea.invalid" class="invalid-feedback">
                <div *ngIf="textarea.errors.required" class="error"> ****</div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <!-- for -->
      <div>
        <div class="row" style="margin-top:3.0rem;">
          <div class="col-lg-6 col-md-6 col-sm-6">
            <div class="form-group">
              <div class="control-label col-lg-4  col-md-4 col-sm-4">
                <h4 style="font-size: 2.4rem;">Map Permission</h4>
              </div>
            </div>
          </div>
          <div class="col-lg-6 col-md-6 col-sm-6">
            <div class="form-group">
              <div class="col-lg-12" style="text-align: right; padding-right: 0;">
                <button type="submit" id="selectobject" [disabled]="!f.form.valid" (click)="openDialog()" [style.color]="f.invalid ? 'gray' : '#27AE60'"
                        id="validationbutton" class="material-icons gamepad_icon">gamepad </button>
                <button style="top: .6rem; font-size: 1.6rem; font-weight: bold;" id="validationbutton" [disabled]="!f.form.valid" (click)="openDialog()" [style.color]="f.invalid ? 'gray' : '#27AE60'">Select Object To Add</button>
              </div>
            </div>
          </div>
        </div>
        <mat-divider style="position: relative;border-top-color: rgba(0,0,0,.12);"></mat-divider>
      </div>
    </form>
    <ngx-spinner id="spinner" size="large" type="ball-spin-clockwise">
    </ngx-spinner>
    <!--custom code END-->
    <div>
      <mat-accordion id="shadow"  multi="true">
        <mat-expansion-panel [disabled]="isDisabled" [expanded]="webExpend" *ngIf="webobject.length > 0" id="box-shadow">
          <mat-expansion-panel-header>
            Web Permission Mapping
          </mat-expansion-panel-header>
          `

          <div id="box-shadow" class="example-container table_scroll mat-elevation-z8  map_permission_table">

            <table aria-describedby="table" mat-table [dataSource]="webobject" multiTemplateDataRows id="box-shadow">
              <ng-container matColumnDef="subEntityName">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 20%"> Entity</th>
                <td mat-cell *matCellDef="let element"> {{element.subEntityName}} </td>
              </ng-container>
              <ng-container matColumnDef="moduleName">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Function Module</th>
                <td mat-cell *matCellDef="let element">{{element.moduleName}}</td>
              </ng-container>
              <ng-container matColumnDef="entityName">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Section Name</th>
                <td mat-cell *matCellDef="let element">{{element.entityName}}</td>
              </ng-container>

              <!-- Name Column -->
              <ng-container matColumnDef="create">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Create </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox  (change)="createMap(element,$event)" [(ngModel)]="element.createFlag"></mat-checkbox>
                </td>
              </ng-container>

              <!-- Weight Column -->
              <ng-container matColumnDef="update">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Update </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox [(ngModel)]="element.updateFlag" (change)="updateMap(element,$event)"></mat-checkbox>
                </td>
              </ng-container>

              <!-- Symbol Column -->
              <ng-container matColumnDef="read">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Read </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox  [(ngModel)]="element.readFlag" (change)="readMap(element,$event)"></mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="symbol"  >
                <th scope="row" class="tlable" class="tlable" mat-header-cell *matHeaderCellDef style="width: 15%"> Field Level Exclusion </th>
                <td style="color:#81C784;" mat-cell *matCellDef="let element"
                    [class.example-expanded-row]="expandedElement === element"
                    (click)="expandedElement = expandedElement === element ? null : element">
                  <div *ngIf="element.readFlag==true && !element.isCreateUpdateAttributePermission">
                    <mat-icon  class="example-icon" style="cursor:pointer;">arrow_downward</mat-icon>
                    <span style="cursor:pointer; margin-left:1rem">Details</span>
                  </div>
                </td>
              </ng-container>
              <ng-container matColumnDef="delete">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%">
                </th>
                <td mat-cell  *matCellDef="let element; let j = index" >

              <span   name='a'>
                <button mat-button color="warn" (click)="removeObject(element,j)"   >
                  <mat-icon  style="cursor: pointer;" class="example-icon">delete</mat-icon>
                </button>
               </span>
                </td>
              </ng-container>

              <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
              <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                  <div class="example-element-detail"
                       [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                    <div class="example-element-description">

                      <table aria-describedby="table" *ngIf="!element.isCreateUpdateAttributePermission">
                        <tr>
                          <th scope="row"></th>
                          <th scope="row">Attributes</th>
                          <th scope="row" style="padding-left: 14.0rem;">Exclusions</th>


                          <th scope="row"></th>
                        </tr>

                        <tr *ngFor="let a of element.attributeExclutionList; ">
                          <td></td>

                          <td>{{a.attributeName}}</td>

                          <td style="float: right;">
                            <mat-checkbox [(ngModel)]="a.readFlag" [disabled]="element.isPublic ==1"
                                          (change)="readAttributeExclution(a, 33,$event)"> </mat-checkbox>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
              <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="example-element-row">
              </tr>
              <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
            </table>



          </div>

          <hr class=" mt-0 horizontal">

        </mat-expansion-panel>
        <mat-expansion-panel (opened)="panelOpenState = true" [expanded]="mobileExpend" (closed)="panelOpenState = false"
                             *ngIf="mobileobject.length >0" id="box-shadow">
          <mat-expansion-panel-header>
            Mobile Permission Mapping

          </mat-expansion-panel-header>

          <div class="example-container mat-elevation-z8 table_scroll  map_permission_table">
            <table aria-describedby="table" mat-table [dataSource]="mobileobject" multiTemplateDataRows>

              <ng-container matColumnDef="subEntityName" style="padding-left: .7rem;">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 20%"> Entity </th>
                <td mat-cell *matCellDef="let element"> {{element.subEntityName}} </td>
              </ng-container>
              <ng-container matColumnDef="moduleName" style="padding-left: .7rem;">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Function Module</th>
                <td mat-cell *matCellDef="let element">{{element.moduleName}}</td>
              </ng-container>
              <ng-container matColumnDef="entityName" style="padding-left: .7rem;">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Section Name</th>
                <td mat-cell *matCellDef="let element">{{element.entityName}}</td>
              </ng-container>

              <ng-container matColumnDef="create">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Create </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox  (change)="McreateMap(element,$event)" [(ngModel)]="element.createFlag"></mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="update">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Update </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox  (change)="MupdateMap(element,$event)" [(ngModel)]="element.updateFlag"></mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="read">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%"> Read </th>
                <td mat-cell *matCellDef="let element">
                  <mat-checkbox [(ngModel)]="element.readFlag" (change)="MreadMap(element,$event)"></mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="symbol">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 15%"> Field Level Exclusion </th>
                <td style="    color:  #81C784;" mat-cell *matCellDef="let element"
                    [class.example-expanded-row]="expandedElement === element"
                    (click)="expandedElement = expandedElement === element ? null : element">
                  <div *ngIf="element.readFlag==true && !element.isCreateUpdateAttributePermission">
                    <mat-icon class="example-icon" style="cursor:pointer;">arrow_downward</mat-icon>                    <span style="cursor:pointer; margin-left:1rem">Details</span>

                  </div>
                </td>
              </ng-container>
              <ng-container matColumnDef="delete">
                <th scope="row" mat-header-cell *matHeaderCellDef style="width: 10%">
                </th>
                <td mat-cell  *matCellDef="let element; let j = index" >

              <span    name='a'>
                <button mat-button color="warn" (click)="removeObject(element,j)"   >
                  <mat-icon  style="cursor: pointer;" class="example-icon">delete</mat-icon>
                </button>

               </span>
                </td>
              </ng-container>
              <ng-container matColumnDef="expandedDetail">
                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                  <div class="example-element-detail"
                       [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                    <div class="example-element-description">
                      <table aria-describedby="table" *ngIf="!element.isCreateUpdateAttributePermission">
                        <tr>
                          <th scope="row"></th>
                          <th scope="row">Attributes</th>
                          <th scope="row" style="padding-left: 14.0rem;">Exclusions</th>
                          <th scope="row"></th>
                        </tr>
                        <tr *ngFor="let a of element.attributeExclutionList; ">
                          <td></td>
                          <td>{{a.attributeName}}</td>

                          <td style="padding-left: 14.7rem;">
                            <mat-checkbox [(ngModel)]="a.readFlag" [disabled]="element.isPublic ==1"
                                          (change)="readAttributeExclution(a,34,$event)"> </mat-checkbox>
                          </td>
                        </tr>

                      </table>
                    </div>
                  </div>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
              <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="example-element-row">
              </tr>
              <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
            </table>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
    <div class="example-button-row text-center" style="margin-top: 5%; margin-bottom: 3%;">
      <button id= "submitButton" class="btn1" style="text-align: center"
              [disabled]="!f.form.valid "
              mat-raised-button color="primary"
              (click)="createRole()">
        <u>S</u><span>UBMIT</span>
      </button>

    </div>
  </mat-card>
</div>
