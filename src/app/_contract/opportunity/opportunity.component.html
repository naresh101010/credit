
<form class="hero-content retailContainer">
  <div class="row text-left parent">      
      <div class="breadcrumb">
        <a routerLink="/retail-contract/retail" target="_self">Dashboard</a><span class="fa fa-caret-right"></span>
        <a routerLink="/retail-contract/retail" target="_self">Contracts</a><span class="fa fa-caret-right"></span>
        <a routerLink="/retail-contract/retail" target="_self">Customer</a><span class="fa fa-caret-right"></span>
        CREDIT
    </div>
    <stepper></stepper>
  </div>

<h3>Credit Contract</h3>
<div *ngIf="isDataAvailable" id="mat-card-heading" fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-between center" fxLayoutAlign.xs="space-between start" class="mat-card-header-container">
    <div fxFlex=33 fxFlex.xs=100 fxLayout="row" fxLayoutAlign="start"><span>Customer Name : </span><span>{{custName}}</span></div>
    <div fxFlex=33 fxFlex.xs=100 fxLayout="row" fxLayoutAlign="start"><span>Salesforce Account Id : </span><span>{{sfdcAccId}}</span></div>
    <div fxFlex=33 fxFlex.xs=100 fxLayout="row" fxLayoutAlign="start"><span>SFX Code : </span><em>{{cntrCode}}</em></div>
  </div>

<mat-card>
    <form form name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate *ngIf="isDataAvailable">
  <!--custom code START-->
  <div>
      <div class="row paddingleftzero" >
      <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
          <div class="row ">
            <div class="col-lg-6 col-md-6 label-text">Business Type<span style="color: red;"> *</span></div>
            <div class="col-lg-6 col-md-6 label-text-value">              
                  <mat-form-field appearance="outline" style="width: 88%;">
                    <mat-select required #businessType='ngModel'  [disabled]="isDisable" (selectionChange)="changeBusinessType()" name ="lkpBizTypeId" [(ngModel)]="model.lkpBizTypeId">
                      <mat-option *ngFor="let b of businessTypeList"[value]="b.id">{{b.lookupVal}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field> 
                  <app-validation-msg *ngIf="(businessType.errors?.required && businessType.touched)" [msg]="'Required !'"></app-validation-msg>
                </div>
          </div>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
            </div>
  
            <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
                <div class="">
                  <div class="col-lg-6 col-md-6 label-text paddingleftzero">Folio No.<span style="color: red;"> *</span></div>
                  <div class="col-lg-6 col-md-6 label-text-value">              
                      <mat-form-field class="selectwidth" appearance="outline" style="width: 89%;" >
                        <input id="contract-input" [disabled]="isDisable" [ngClass]="{ 'is-invalid':folio.invalid }" required
                         name="folio" #folio="ngModel" numeric decimals="2" matInput name ="folioNum" [(ngModel)]="model.folioNum" maxlength="10">
                      </mat-form-field> 
                 <app-validation-msg *ngIf="(folio.errors?.required && folio.touched)" [msg]="'Required !'"></app-validation-msg>
                    </div>
                </div>
            </div>
          </div>
  </div>

<!-- First Row -->

<div>
  <div class="row">
    <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
      <div class="row ">
        <div class="col-lg-6 col-md-6 label-text">Contract Status </div>
        <div class="col-lg-6 col-md-6 label-text-value">
          <mat-form-field appearance="outline" style="width: 88%;">
            <mat-select  [disabled]="!isDisable" name ="status" [(ngModel)]="model.status" (selectionChange)="setExpiryDate()">
              <mat-option *ngFor="let b of statusList"[value]="b.id">{{b.lookupVal}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      </div>
      <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4"></div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">            
              <div class="col-lg-6 col-md-6 label-text paddingleftzero">Direct Pick Up</div>
              <div class="col-lg-6 col-md-6 label-text-value">                            
                      <mat-radio-group style="padding-left: 1rem !important;" [disabled]="isDisable" *ngFor="let season of gst" class="example-radio-group" name="directPickupFlag" [(ngModel)]="model.directPickupFlag" >
                          <mat-radio-button class="example-radio-button" [value]="season.id">
                            {{season.value}}
                          </mat-radio-button>
                        </mat-radio-group>
                </div>
                </div>      
  </div>
</div>
<!-- First Row end -->

<!-- Second Row -->
<div>
  <div class="row">
      <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
          <div class="row ">
            <div class="col-lg-6 col-md-6 label-text">Opportunity Type</div>
            <div class="col-lg-6 col-md-6 label-text-value">{{oportunity.responseData.lkpOpprType}}</div>
          </div>
          </div>
          <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4"></div>
          <!-- Delivery Hold -->
          <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4"*ngIf="model.lkpBizTypeValue=='INBOUND'" >	
            <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6 label-text paddingleftzero">Delivery Hold</div>
            <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6">
                <mat-radio-group [disabled]="isDisable" style="padding-left: 1rem !important;" *ngFor="let season of gst" class="example-radio-group"
                 name = "dlvryHoldFlag" [(ngModel)]="model.dlvryHoldFlag" >
                  <mat-radio-button class="example-radio-button" [value]="season.id">
                    {{season.value}}
                  </mat-radio-button>
                </mat-radio-group>
            </div>
        </div>

 

  </div>
  
    <div class="row ">
      <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6">						
        <div class="row">
          <div class="col-lg-4 col-md-4 label-text paddingrightzero">Salesforce Opportunity&nbsp;No.</div>
          <div class="col-lg-4 col-md-4 label-text-value">{{oportunity.responseData.sfdcOpprId}}({{oportunity.responseData.opprName}})</div>
          <div *ngIf="!model.id" class="col-lg-4 col-md-4 label-text-value">
              <div class="col-lg-12 col-md-12 label-text-value">
              <mat-radio-group [disabled]="isDisable" aria-label="Select an option" [value]='SFXTypes[0]' name="sfxtype" *ngFor="let type of SFXTypes"
              (change)="changeSfxType(type)">
                <mat-radio-button class="example-radio-button" [value]="type">
                  {{type}}
                </mat-radio-button>
              </mat-radio-group>
            </div>
          </div>
        </div>     
        </div>
         <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2"></div>
         <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4" >	
          <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6 label-text paddingleftzero" >Segment<span style="color: red;"> *</span> </div>
          <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6">
          <mat-form-field appearance="outline" class="inputBox">
            <mat-select required #segment='ngModel' [disabled]="isDisable" name ="segmentId" placeholder="Select Segment" [(ngModel)]="model.segmentId" (selectionChange)=getSubsegment(model.segmentId) >
              <mat-option *ngFor="let item of segmentList" [value]="item.id">
                {{item.segmentName}}
              </mat-option>
            </mat-select>
          </mat-form-field> 
          <app-validation-msg *ngIf="(segment.errors?.required && segment.touched)" [msg]="'Required !'"></app-validation-msg>              
          </div>
      </div>
    </div>
  </div>
  <!-- End of Second Row -->
  <div class="row">
  <div class=" col-lg-4 col-md-4 col-sm-4 col-xl-4">						
    <div class="row">
      <div class="col-lg-6 col-md-6 label-text">Opportunity Address</div>
      <div class="col-lg-6 col-md-6 label-text-value" *ngFor="let data of opprAddr"> {{data.addr}}</div>
    </div>
    </div>
    <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4" ></div>
      
    <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4" >	
      <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6 label-text paddingleftzero">Sub Segment <span style="color: red;"> *</span></div>
      <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6">
      <mat-form-field appearance="outline" class="inputBox">
        <mat-select required #subSegment='ngModel' (selectionChange)=segmentFlg() name ="subsegmentId" [disabled]="isDisable" placeholder="Select Subsegment" [(ngModel)]="model.subsegmentId">
          <mat-option *ngFor="let item of subSegmentList" [value]="item.id">
            {{item.subsegmentName}}
          </mat-option>
        </mat-select>
      </mat-form-field>   
      <p>
        <app-validation-msg *ngIf="(subSegmentFlage) && !subSegment.errors?.required" [msg]="'Required !'"></app-validation-msg>
      <app-validation-msg *ngIf="(subSegment.errors?.required && subSegment.touched && subSegmentFlage)" [msg]="'Required !'"></app-validation-msg></p>
      </div>
  </div>    
  </div>

  <!-- Third Row -->
  <div>
      <div class="row">  
          <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">	
             <div class="row" >
                  <div class="col-lg-6 col-md-6 label-text">Contract Type</div>
                  <div class="col-lg-6 col-md-6 label-text-value">              
                      <div  class="col-lg-6 col-md-6 label-text-value paddingleftzero"> {{model.cntrTypeValue}}</div>
                      </div>
                </div>
              </div>

              <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">		</div>         
      </div>
    </div>

  <!-- Third Row end -->

  <!-- Fourth Row start -->
      <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
            <div class="row">
              <div class="col-lg-6  col-md-6 col-sm-6 col-xs-6 label-text">Contract Sign Date <span style="color: red;"> *</span></div>
              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 label-text-value div-space rightpadding" >
                <mat-form-field  appearance="outline"  id="datepickerwidth">
                  <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-datepicker panelClass="creditDatepicker" #picker></mat-datepicker>
                  <input Datepicker required #cntrSignDt="ngModel" [disabled]="isDisable" required [ngClass]="{ 'is-invalid':    cntrSignDt.invalid }"
                   matInput [matDatepicker]="picker" class="date_picker"  placeholder="DD/MM/YY" name ="cntrSignDt" [(ngModel)]="model.cntrSignDt">   
                  </mat-form-field> 
              
                  <app-validation-msg *ngIf="(cntrSignDt.errors?.required && cntrSignDt.touched)" [msg]="'Required !'"></app-validation-msg>

              </div>
            </div>
            </div>
        </div>


  <!-- End of fourth row -->

  <!-- start of Fifth Row -->

  <div>
    <div class="row">
        <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
            <div class="row">
              <div class="col-lg-6 col-md-6 label-text">Contract Start Date<span style="color: red;"> *</span></div>
              <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 label-text-value div-space rightpadding">
                <mat-form-field appearance="outline" id="datepickerwidth">
                  <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
                  <mat-datepicker panelClass="creditDatepicker" #pickerTo></mat-datepicker>   
                  <input Datepicker #effectiveDt="ngModel" required [disabled]="isDisable" [ngClass]="{ 'is-invalid':    effectiveDt.invalid }"
                  matInput [matDatepicker]="pickerTo" class="date_picker"  name ="effectiveDt" [(ngModel)]="model.effectiveDt" placeholder="DD/MM/YY">   
                </mat-form-field>
                 <!-- validation -->
                 <br>
                 <app-validation-msg *ngIf="(effectiveDt.errors?.required && effectiveDt.touched)" [msg]="'Required !'"></app-validation-msg>
                <!-- validation -->
              </div>
            </div>
            </div>


            <div class="col-lg-4 col-md-4 col-sm-4 col-xl-4">						
                <div class="row">
                  <div class="col-lg-6 col-md-6 label-text">Contract End Date<span style="color: red;"> *</span></div>
                  <div class="col-lg-4 col-md-4 label-text-value rightpadding">              
                    <mat-form-field  appearance="outline"  id="datepickerwidth">
                      <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                      <mat-datepicker panelClass="creditDatepicker" #picker2></mat-datepicker>
                      <input Datepicker [min]="maxNewDate" #expDt="ngModel" required [disabled]="disableExp" [ngClass]="{ 'is-invalid':    expDt.invalid }"
                       matInput [matDatepicker]="picker2" class="date_picker"  placeholder="DD/MM/YY" name ="expDt" [(ngModel)]="model.expDt">   
                    </mat-form-field>
                    <br>
                    <app-validation-msg *ngIf="(expDt.errors?.required && expDt.touched)" [msg]="'Required !'"></app-validation-msg>
                  </div>
                </div>
                </div>
    </div>
            <div *ngIf="isDisable">
              <div class="row margintop20">
                <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2">						
                    <div class="label-text">Reason For Termination</div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xl-2">
                  <mat-form-field appearance="outline">
                    <mat-select name ="reasonId" placeholder="Select Reason" [(ngModel)]="reasonId">
                      <mat-option *ngFor="let item of reasonList" [value]="item.id">
                        {{item.lookupVal}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
              <div class="row margintop20">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xl-12">						
                  <div class="row">
                    <div class="col-lg-2 col-md-2 label-text">Remarks</div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xl-6">
                      <textarea name="desc" [(ngModel)]="model.desc" style="width: 50%;height: 6.0rem;"></textarea>
                    </div>
                    </div>
                </div>
              </div>
              </div>
  </div>

  <!-- End of Fifth row -->
<!-- end sfx -->  

<div style="margin-top: 3%;">
  <div *ngIf="!isDisable">
  <mat-accordion>       
    <div class="example-button-row text-center" style="margin-top: 5%">
      <button class="btn1" id="secondry-button" [disabled]='!f.form.valid'  mat-raised-button color="primary"(click)="postOportunity()">Save As Draft</button> 
      <button class="btn1" style="text-align: center" [disabled]='!f.form.valid'  mat-raised-button color="primary" (click)="opportunityNext()">Next</button>
      </div>
  </mat-accordion>
</div>
<div class="box" *ngIf="isDisable">
  <div class="row">
  <div class="col-lg-3 col-lg-3 col-sm-3 col-md-3" style="margin-top: 3%;">
  
  </div>
  <div class="col-lg-6 col-lg-6 col-sm-6 col-md-6"></div>
  <div class="col-lg-3 col-lg-3 col-sm-3 col-md-3 text-right" style="margin-top: 3%;">
    <div class="example-button-row text-center">
      <button mat-button  class="btn1" style="text-align: center; margin-top: 5%; margin-bottom: 2%;" mat-raised-button
      (click)="submitTermNClose()" color="primary">SUBMIT</button>
</div>
  </div>
  </div>
</div>
</div>
    </form>
</mat-card>
</form>

<ngx-spinner id="spinner" size="large" type="ball-spin-clockwise">  

</ngx-spinner>


